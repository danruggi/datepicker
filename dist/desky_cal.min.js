function adjustCalendarPosition(t){const{bottom:e,right:s}=t.getBoundingClientRect();window.innerHeight;s>window.innerWidth&&(t.style.right="2px")}function generateDowList(){const t=new Date(2021,8);let e="";for(let s=1;s<=21;s++){t.setDate(s);const n=t.toLocaleString("default",{weekday:"long"}).charAt(0);if(0===e.length&&0!==t.getDay()||(e+=`<span>${n}</span>`),6===t.getDay()&&0!==e.length)break}return e}function buildCalendarHTML(t,e){const s=e.mode||"single",n="single"===s?"single":"",i=e.anyDate?buildAnyDateHTML(t):"";return`\n        <div class='desky-dark-container desky-cal-hidden'>\n            <div class='desky-calendar-container ${n}' id='deskycal_${t}'>\n                <span class='desky-cal-close' id='desky-close-${t}'>X</span>\n                ${"double"===s?buildLeftSectionHTML(t):""}\n                <div class='right'>\n                    ${buildRightSectionHTML(t)}\n                    ${i}\n                </div>\n            </div>\n        </div>\n        `}function buildLeftSectionHTML(t){return"\n        <div class='left'>\n            <span class='left-today'>Today</span>\n            <span class='left-day'></span>\n            <span class='left-mon'></span>\n        </div>\n    "}function buildRightSectionHTML(t){return"\n        <div class='desky-cal-right-header arrows'>\n            <span class='desky-arrow sel-prev-month'>&lt;</span>\n            <span class='desky-cal-month-name'></span>\n            <span class='desky-cal-month-num desky-cal-hidden'></span>\n            <span class='desky-arrow sel-next-month'>&gt;</span>\n        </div>\n        <div class='desky-cal-right-bottom'>\n            <div class='desky-cal-dow-list'></div>\n            <div class='desky-cal-day-list'></div>\n        </div>\n    "}function buildAnyDateHTML(t){return`<span data-day='calsel_anyDate_${t}' class='curr-month cal-sel-day any-date-day'>\n                Any Date\n            </span>`}function parseHTML(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}class DeskyCalendar{constructor(t){this.options=t||{},this.t={},this.init()}init(){const t=Object.keys(this.options);0!==t.length?t.forEach((t=>this.i(t))):console.error("Initialize deskyOpts before using this function")}l(t){const e=document.getElementById(t);if(!e)return void console.error(`Input id ${t} not found`);const s=e.parentNode,n=e.cloneNode(!0);n.readOnly=!0,n.dataset.o=t,n.addEventListener("click",(e=>this.h(e,t)));const i=document.createElement("div");i.id=`desky-added-parent-${t}`,i.classList.add("desky-cal-parent","deskycal"),i.dataset.o=t,i.appendChild(n),s.replaceChild(i,e),this.t[t]={u:n,p:i,k:null}}m(t){const e=this.options[t].D||new Date;this.t[t].u.value=this.$(e),this.t[t].v=e;const s=this.options[t].nextInput;s&&(this.options[s].g=e,this.options[s].D=e)}L(t){return t.toISOString().split("T")[0]}$(t){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}T(t){const e=parseHTML(buildCalendarHTML(t,this.options[t]));this.t[t].p.appendChild(e),this.t[t].k=this.t[t].p.querySelector(".desky-dark-container"),this.t[t].k.dataset.o=t,this.t[t].M=this.t[t].k.querySelector(".desky-calendar-container"),this.t[t].M.dataset.o=t;const s=generateDowList(),n=this.t[t].p.querySelector(".desky-cal-dow-list");n&&(n.innerHTML=s),this.t[t].S=this.t[t].p.querySelector(".desky-cal-close"),this.t[t].S.dataset.o=t,this.t[t].S.addEventListener("click",(e=>this._(e,t)));const i=this.t[t].p.querySelector(".sel-next-month");i&&i.addEventListener("click",(e=>this.C(t)));const a=this.t[t].p.querySelector(".sel-prev-month");a&&a.addEventListener("click",(e=>this.H(t)));const l=this.t[t].M.querySelector(".left");l&&l.addEventListener("click",(e=>this.I(l,t)));const o=this.t[t].M.querySelector(".any-date-day");o&&o.addEventListener("click",(e=>this.I(o,t)))}N(t,e,s){let n=new Date,i="",a="",l=this.t[t].M.querySelector(".desky-cal-month-name"),o=this.t[t].M.querySelector(".desky-cal-month-num"),d=this.t[t].M.querySelector(".desky-cal-day-list");isNaN(e)&&(e=n.getFullYear()),isNaN(s)&&(s=n.getMonth());let r=new Date(e,s,1),c=new Date(e,s+1,0),h=r.getDay(),u=c.getDay(),p=r.toLocaleString("default",{month:"long"}),y=new Date,g=y.toLocaleString("default",{month:"long"}),k=`calsel_${e}_${y.getMonth()+1}_${y.getDate()}`;"double"===this.options[t].mode&&(this.t[t].M.querySelector(".left-day").innerText=n.getDate(),this.t[t].M.querySelector(".left-mon").innerText=g,this.t[t].M.querySelector(".left").dataset.day=k),l.innerText=`${p} ${r.getFullYear()}`,o.innerText=`${s}_${e}`;let m=s+1,v=(r.getDate(),c.getDate()),D=new Date(e,s,0).getDate();for(let t=D-h+1;t<=D;t++)i+=`<span class='last-month cal-sel-day'>\n                        ${t}\n                    </span>`;let f=new Date;f.setMonth(s);for(let s=1;s<=v;s++){f=new Date(f.setDate(s)),a=`calsel_${e}_${m}_${f.getDate()}`;let n="";k===a&&(n="today"),this.options[t].g&&f.getTime()<this.options[t].g.getTime()&&(n="disabled"),this.options[t].disableAfter&&f.getTime()>this.options[t].disableAfter.getTime()&&(n="disabled"),i+=`<span data-day='${a}' class='curr-month cal-sel-day ${n}'>\n                        ${f.getDate()}\n                    </span>`}for(let t=1;t<7-u;t++)f=new Date,f.setDate(t),f.setMonth(s+1),i+=`<span class='next-month cal-sel-day'>\n                        ${f.getDate()}\n                    </span>`;let L=parseHTML(i);for(;d.firstChild;)d.removeChild(d.lastChild);d.appendChild(L),this.A(d,t)}A(t,e){t.querySelectorAll(".cal-sel-day").forEach((t=>{t.addEventListener("click",(s=>this.I(t,e)))}))}H(t){let e=this.t[t].M.querySelector(".desky-cal-month-num").innerText.split("_"),s=parseInt(e[0])-1,n=parseInt(e[1]);s<0&&(s=11,n--),this.N(t,n,s)}C(t){let e=this.t[t].M.querySelector(".desky-cal-month-num").innerText.split("_"),s=parseInt(e[0])+1,n=parseInt(e[1]);s>11&&(s=0,n++),this.N(t,n,s)}h(t,e){t.stopPropagation(),this.t[e].k.classList.toggle("desky-cal-hidden"),this.options[e].scroll&&this.t[e].M.scrollIntoView({behavior:"smooth",P:"center"}),adjustCalendarPosition(this.t[e].M);let s=(new Date).getFullYear(),n=(new Date).getMonth();this.t[e].v&&(s=this.t[e].v.getFullYear(),n=this.t[e].v.getMonth()),this.N(e,s,n);const i=t=>this._(t,e);this.t[e].j=i,document.addEventListener("mouseup",i)}I(t,e){if(t.classList.contains("disabled"))return;t.classList.add("clicked");let s=t.dataset.day.split("_"),n=new Date;"anyDate"==s[1]?(this.t[e].u.value="Any Date",this.t[e].v=null):(n.setFullYear(s[1]),n.setMonth(s[2]-1),n.setDate(s[3]),this.t[e].u.value=this.$(n),this.t[e].v=n),"function"==typeof this.options[e].callback&&this.options[e].callback(this.t[e].v),null!=this.options[e].nextInput&&this.O(e);setTimeout((()=>{t.classList.remove("clicked"),this._(null,e)}),300)}O(t){let e=this.options[t].nextInput;const s=this.t[t].v;s?(this.options[e].g=s,this.t[e].v=s,this.t[e].u.value=this.$(s)):(this.options[e].g=null,this.t[e].v=null,this.t[e].u.value=this.$(new Date))}_(t,e){if(!e)return void console.error("Missing id");const s=this.t[e].S;return t&&s&&s.contains(t.target)||t&&!this.t[e].k.contains(t.target)?(this.t[e].k.classList.add("desky-cal-hidden"),void document.removeEventListener("mouseup",this.t[e].j)):void(t||(this.t[e].k.classList.add("desky-cal-hidden"),document.removeEventListener("mouseup",this.t[e].j)))}i(t){this.l(t),this.m(t),this.T(t)}}
